webpackJsonp([5],{AeU6:function(e,t,n){"use strict";function a(e){n("E2XZ")}Object.defineProperty(t,"__esModule",{value:!0});var s=n("SpS4"),r=n.n(s);for(var i in s)"default"!==i&&function(e){n.d(t,e,function(){return s[e]})}(i);var o=n("PlNS"),u=n("C7Lr"),l=a,c=u(r.a,o.a,!1,l,null,null);t.default=c.exports},E2XZ:function(e,t,n){var a=n("P9F+");"string"==typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);n("FIqI")("25ea8458",a,!0,{})},"P9F+":function(e,t,n){t=e.exports=n("UTlt")(!0),t.push([e.i,"\n.m-authsManage-purchaseManage{\n  padding: 20px;\n}\n.m-authsManage-purchaseManage-header{\n  margin-bottom: 20px;\n}\n.m-authsManage-purchaseManage-dialog .el-input {\n  width: 100px;\n}\n.m-authsManage-purchaseManage-dialog .el-form {\n  padding: 20px;\n}\n.m-authsManage-purchaseManage-dialog .el-checkbox{\n  display: block;\n  margin: 0 !important;\n}\n.cancel-btn {\n  position: absolute;\n  right: 110px;\n  top: 18px;\n}\n","",{version:3,sources:["D:/vue_source/sku-manage/src/modules/authsManage/purchaseManage.vue"],names:[],mappings:";AACA;EACE,cAAc;CACf;AACD;EACE,oBAAoB;CACrB;AACD;EACE,aAAa;CACd;AACD;EACE,cAAc;CACf;AACD;EACE,eAAe;EACf,qBAAqB;CACtB;AACD;EACE,mBAAmB;EACnB,aAAa;EACb,UAAU;CACX",file:"purchaseManage.vue",sourcesContent:["\n.m-authsManage-purchaseManage{\n  padding: 20px;\n}\n.m-authsManage-purchaseManage-header{\n  margin-bottom: 20px;\n}\n.m-authsManage-purchaseManage-dialog .el-input {\n  width: 100px;\n}\n.m-authsManage-purchaseManage-dialog .el-form {\n  padding: 20px;\n}\n.m-authsManage-purchaseManage-dialog .el-checkbox{\n  display: block;\n  margin: 0 !important;\n}\n.cancel-btn {\n  position: absolute;\n  right: 110px;\n  top: 18px;\n}\n"],sourceRoot:""}])},PlNS:function(e,t,n){"use strict";var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"m-authsManage-purchaseManage"},[n("div",{staticClass:"m-authsManage-purchaseManage-form "},[n("el-form",{ref:"form",attrs:{model:e.form,"label-width":"80px"}},[n("el-row",[n("el-col",{attrs:{span:8}},[n("el-form-item",{attrs:{label:"sku"}},[n("el-input",{model:{value:e.form.sku,callback:function(t){e.$set(e.form,"sku",t)},expression:"form.sku"}})],1)],1),e._v(" "),n("el-col",{attrs:{span:5}},[n("el-form-item",{attrs:{label:"数量"}},[[n("el-input-number",{attrs:{min:1,max:1e3,label:"描述文字"},on:{change:e.handleChange},model:{value:e.form.number,callback:function(t){e.$set(e.form,"number",t)},expression:"form.number"}})]],2)],1),e._v(" "),n("el-col",{attrs:{span:8}},[n("el-form-item",[n("el-button",{attrs:{type:"primary"},on:{click:e.onAddSkuEvent}},[e._v("添加")]),e._v(" "),n("el-button",{on:{click:e.onCancelSkuEvent}},[e._v(" 重置")])],1)],1)],1)],1)],1),e._v(" "),n("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.rows,stripe:""}},[n("el-table-column",{attrs:{prop:"name",label:"款式名"}}),e._v(" "),n("el-table-column",{attrs:{prop:"size",label:"尺码"}}),e._v(" "),n("el-table-column",{attrs:{label:"SKU"},scopedSlots:e._u([{key:"default",fn:function(t){return e._l(t.row.sku,function(t){return n("div",{key:t.index},[n("el-tag",[e._v("\n            "+e._s(t)+"\n          ")])],1)})}}])}),e._v(" "),n("el-table-column",{attrs:{label:"采购链接","min-width":"300"},scopedSlots:e._u([{key:"default",fn:function(t){return e._l(t.row.purchase_url,function(t){return n("div",{key:t.index},[n("a",{staticClass:"buttonText",attrs:{href:t,target:"url"}},[e._v(e._s(t))])])})}}])}),e._v(" "),n("el-table-column",{attrs:{prop:"image_url",label:"款式图"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("el-popover",{attrs:{placement:"right",title:"",trigger:"hover"}},[n("img",{staticStyle:{width:"300px",height:"auto",display:"block"},attrs:{src:t.row.image_url}}),e._v(" "),n("img",{staticStyle:{width:"70px",height:"auto",display:"block"},attrs:{slot:"reference",src:t.row.image_url,alt:t.row.image_url},slot:"reference"})])]}}])}),e._v(" "),n("el-table-column",{attrs:{prop:"number",label:"数量",width:"80"}}),e._v(" "),n("el-table-column",{attrs:{label:"操作",width:"160"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("el-button",{attrs:{type:"text"},nativeOn:{click:function(n){return n.preventDefault(),e.onEditEvent(t.$index)}}},[e._v("\n          编辑\n        ")]),e._v(" "),n("el-button",{attrs:{type:"text"},nativeOn:{click:function(n){return n.preventDefault(),e.onDetailEvent(t.$index)}}},[e._v("\n          详情\n        ")])]}}])})],1),e._v(" "),n("el-dialog",{staticClass:"m-authsManage-purchaseManage-dialog",attrs:{"append-to-body":"",title:e.isEdit?"编辑采购sku":"采购sku详情",visible:e.showEditDialog},on:{"update:visible":function(t){e.showEditDialog=t}}},[n("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.skuLoading,expression:"skuLoading"}],staticStyle:{width:"100%"},attrs:{data:e.items,stripe:""}},[n("el-table-column",{attrs:{prop:"sku",label:"sku"}}),e._v(" "),n("el-table-column",{attrs:{width:"300px",label:"数量"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.edit?[n("el-input",{staticClass:"edit-input",model:{value:t.row.number,callback:function(n){e.$set(t.row,"number",n)},expression:"scope.row.number"}}),e._v(" "),n("el-button",{staticClass:"cancel-btn",attrs:{size:"small",type:"warning"},on:{click:function(n){return e.cancelSkuEdit(t.row)}}},[e._v("\n            取消\n          ")])]:n("span",[e._v(e._s(t.row.number))])]}}])}),e._v(" "),e.isEdit?n("el-table-column",{attrs:{label:"操作",width:"150px"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.edit?n("el-button",{attrs:{type:"success",size:"small"},on:{click:function(n){return e.confirmSkuEdit(t.row)}}},[e._v("\n          确定\n        ")]):n("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(e){t.row.edit=!t.row.edit}}},[e._v("\n          编辑\n        ")]),e._v(" "),n("el-button",{attrs:{type:"text"},nativeOn:{click:function(n){return n.preventDefault(),e.onDelEvent(t.row)}}},[e._v("\n          删除\n        ")])]}}],null,!1,1774367963)}):e._e()],1)],1)],1)},s=[],r={render:a,staticRenderFns:s};t.a=r},SpS4:function(e,t,n){"use strict";function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}Object.defineProperty(t,"__esModule",{value:!0});var s=n("4650");t.default={data:function(){var e;return e={rows:[],items:[],rules:{role_name:[{required:!0,message:"请输入角色名称",trigger:"blur"}],department_id:[{type:"number",required:!0,message:"请选择所属部门",trigger:"change"}]},loading:!0,skuLoading:!0,isEdit:!1,form:{sku:"",number:0},showEditDialog:!1},a(e,"isEdit",!1),a(e,"role_id",0),e},methods:{fetchList:function(){var e=this,t=sessionStorage.getItem("ts_user_id");(0,s.rest)({url:"/v1/inspect/"+t+"/purchase/list?role_id="+this.role_id,headers:{"X-Inspect-Token":sessionStorage.getItem("ts_userToken")},method:"GET"}).then(function(t){e.rows=t.data,e.loading=!1}).catch(function(t){e.$message.error(t.response.data.msg)})},handleChange:function(e){},addItem:function(e){var t=this,n=sessionStorage.getItem("ts_user_id");return(0,s.rest)({url:"/v1/inspect/"+n+"/purchase/add",headers:{"X-Inspect-Token":sessionStorage.getItem("ts_userToken")},method:"POST",data:e}).then(function(e){t.$message({message:"新增采购sku成功，请在列表中查看！",type:"success"})}).catch(function(e){t.$message.error(e.response.data.msg)})},updateItem:function(e){var t=this,n=sessionStorage.getItem("ts_user_id");return(0,s.rest)({url:"/v1/inspect/"+n+"/purchase/update",headers:{"X-Inspect-Token":sessionStorage.getItem("ts_userToken")},method:"POST",data:e}).then(function(e){t.$message({message:"编辑采购sku成功，请在列表中查看！",type:"success"})}).catch(function(e){t.$message.error(e.response.data.msg)})},deleteItem:function(e){var t=this,n=sessionStorage.getItem("ts_user_id");return(0,s.rest)({url:"/v1/inspect/"+n+"/purchase/delete",headers:{"X-Inspect-Token":sessionStorage.getItem("ts_userToken")},method:"POST",data:e}).then(function(e){t.$message({message:"删除采购sku成功，请在列表中查看！",type:"success"})}).catch(function(e){t.$message.error(e.response.data.msg)})},onAddSkuEvent:function(){var e=this;console.log(this.form.sku," ",this.form.num),this.form.role_id=this.role_id,this.addItem({sku:this.form.sku,number:this.form.number,role_id:parseInt(this.role_id)}).then(function(t){e.fetchList(e.role_id)})},onCancelSkuEvent:function(){this.form.sku="",this.form.number=1},onEditEvent:function(e){var t=this;this.items=this.rows[e].purchase_list.map(function(e){return t.$set(e,"edit",!1),e.originalNumber=e.number,e}),this.skuLoading=!1,this.isEdit=!0,this.showEditDialog=!0,this.$refs.itemForm&&this.$refs.itemForm.clearValidate()},onDetailEvent:function(e){this.items=this.rows[e].purchase_list,this.isEdit=!1,this.skuLoading=!1,this.showEditDialog=!0,this.$refs.itemForm&&this.$refs.itemForm.clearValidate()},onDelEvent:function(e){var t=this;this.$confirm("本次操作将永久删除该采购sku, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t.items.splice(t.items.indexOf(e),1),t.deleteItem({purchase_id:e.id}).then(function(e){t.fetchList()})})},cancelSkuEdit:function(e){e.number=e.originalNumber,e.edit=!1,this.$message({message:"The number has been restored to the original value",type:"warning"})},confirmSkuEdit:function(e){var t=this;e.edit=!1,e.originalNumber=e.number,e.number=parseInt(e.number),this.updateItem(e).then(function(e){t.fetchList()}),this.$message({message:"The number has been edited",type:"success"})}},mounted:function(){this.role_id=this.$route.query.role_id,this.fetchList()}}}});
//# sourceMappingURL=5.ce3cc5b3653f2d69dea5.js.map