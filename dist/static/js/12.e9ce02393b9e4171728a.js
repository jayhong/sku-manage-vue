webpackJsonp([12],{"7Dvh":function(t,e,a){var s=a("T4bm");"string"==typeof s&&(s=[[t.i,s,""]]),s.locals&&(t.exports=s.locals);a("rjj0")("8491a9bc",s,!0)},T4bm:function(t,e,a){e=t.exports=a("FZ+f")(!0),e.push([t.i,"\n.m-carManage-carApply{\n  padding: 20px;\n}\n.m-carManage-carApply-header{\n  margin-bottom: 20px;\n}\n.m-carManage-carApply-dialog .detail-title {\n  font-size: 15px;\n  border-bottom: 1px #ddd solid;\n  margin: 20px 0;\n  font-weight: bold;\n}\n","",{version:3,sources:["/Users/wilen/wilen/more/Audit/src/modules/carManage/carApply.vue"],names:[],mappings:";AACA;EACE,cAAc;CACf;AACD;EACE,oBAAoB;CACrB;AACD;EACE,gBAAgB;EAChB,8BAA8B;EAC9B,eAAe;EACf,kBAAkB;CACnB",file:"carApply.vue",sourcesContent:["\n.m-carManage-carApply{\n  padding: 20px;\n}\n.m-carManage-carApply-header{\n  margin-bottom: 20px;\n}\n.m-carManage-carApply-dialog .detail-title {\n  font-size: 15px;\n  border-bottom: 1px #ddd solid;\n  margin: 20px 0;\n  font-weight: bold;\n}\n"],sourceRoot:""}])},f1Nq:function(t,e,a){"use strict";function s(t){a("7Dvh")}Object.defineProperty(e,"__esModule",{value:!0});var n=a("4650"),r={data:function(){return{cols:[{prop:"id",label:"ID"},{prop:"user_name",label:"用户"},{prop:"company",label:"公司"},{prop:"car_lincese",label:"车牌号码"},{prop:"start",label:"开始时间"},{prop:"end",label:"结束时间"},{prop:"status",label:"申请状态"}],rows:[],item:{apply_info:{},car:{},user_info:{}},rules:{company_name:[{required:!0,message:"请输入公司名称",trigger:"blur"}]},loading:!0,detailDialog:!1,isEdit:!1}},filters:{statusFilter:function(t){switch(t){case 0:return"待审核";case 1:return"审核通过";case-1:return"审核驳回"}}},computed:{rows_inShow:function(){return this.rows.map(function(t){return 0===t.status?t.status="待审核":1===t.status?t.status="审核通过":t.status="审核驳回",t})}},methods:{fetchList:function(){var t=this,e=sessionStorage.getItem("ts_user_id");return Object(n.a)({url:"/v1/inspect/"+e+"/car_apply/list",headers:{"X-Inspect-Token":sessionStorage.getItem("ts_userToken")},method:"GET"}).then(function(e){t.rows=e.data.data,t.loading=!1}).catch(function(e){t.$message.error(e.response.data.msg)})},getItem:function(t){var e=this,a=sessionStorage.getItem("ts_user_id");return Object(n.a)({url:"/v1/inspect/"+a+"/car_apply/detail",headers:{"X-Inspect-Token":sessionStorage.getItem("ts_userToken")},params:{apply_id:t}}).then(function(t){e.item=t.data.data}).catch(function(t){e.$message.error(t.response.data.msg)})},passItem:function(t){var e=this,a=sessionStorage.getItem("ts_user_id");return Object(n.a)({url:"/v1/inspect/"+a+"/car_apply/handle",headers:{"X-Inspect-Token":sessionStorage.getItem("ts_userToken")},method:"POST",data:{id:t,status:1,opinion:"通过"}}).then(function(t){e.$message({message:"车辆审核通过！",type:"success"}),e.fetchList()}).catch(function(t){e.$message.error(t.response.data.msg)})},rejectItem:function(t,e){var a=this,s=sessionStorage.getItem("ts_user_id");return Object(n.a)({url:"/v1/inspect/"+s+"/car_apply/handle",headers:{"X-Inspect-Token":sessionStorage.getItem("ts_userToken")},method:"POST",data:{id:t,status:-1,opinion:e}}).then(function(t){a.$message({message:"车辆申请已驳回！",type:"success"}),a.fetchList()}).catch(function(t){a.$message.error(t.response.data.msg)})},onAuditEvent:function(t,e){var a=this;1===e?this.$confirm("是否通过id为"+this.rows[t].id+"的车辆申请？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){a.passItem(a.rows[t].id)}):this.$prompt("驳回该车辆申请（id:"+this.rows[t].id+"）的理由","提示",{confirmButtonText:"确定",cancelButtonText:"取消",inputType:"textarea",inputPattern:/\S/,inputErrorMessage:"请输入驳回理由"}).then(function(e){var s=e.value;a.rejectItem(a.rows[t].id,s)})},onCheckEvent:function(t){this.getItem(this.rows[t].id),this.detailDialog=!0}},mounted:function(){this.fetchList()}},o=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"m-carManage-carApply"},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:t.rows_inShow,stripe:""}},[t._l(t.cols,function(t){return a("el-table-column",{key:t.prop,attrs:{prop:t.prop,label:t.label,width:t.width}})}),t._v(" "),a("el-table-column",{attrs:{label:"操作",width:"200"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{type:"text"},nativeOn:{click:function(a){a.preventDefault(),t.onCheckEvent(e.$index)}}},[t._v("\n          详情\n        ")]),t._v(" "),"审核通过"!==e.row.status?a("el-button",{attrs:{type:"text"},nativeOn:{click:function(a){a.preventDefault(),t.onAuditEvent(e.$index,1)}}},[t._v("\n          通过\n        ")]):t._e(),t._v(" "),"审核驳回"!==e.row.status?a("el-button",{attrs:{type:"text"},nativeOn:{click:function(a){a.preventDefault(),t.onAuditEvent(e.$index,-1)}}},[t._v("\n          驳回\n        ")]):t._e()]}}])})],2),t._v(" "),a("el-dialog",{staticClass:"m-carManage-carApply-dialog",attrs:{"append-to-body":"",title:"车辆申请详情",visible:t.detailDialog},on:{"update:visible":function(e){t.detailDialog=e}}},[a("div",{staticClass:"detail-title"},[t._v("申请信息")]),t._v(" "),a("el-row",[a("el-col",{attrs:{span:12}},[t._v("开始时间："+t._s(t.item.apply_info.start))]),t._v(" "),a("el-col",{attrs:{span:12}},[t._v("结束时间："+t._s(t.item.apply_info.end))])],1),t._v(" "),a("el-row",[a("el-col",{attrs:{span:12}},[t._v("申请用途："+t._s(t.item.apply_info.use))]),t._v(" "),a("el-col",{attrs:{span:12}},[t._v("审核状态："+t._s(t._f("statusFilter")(t.item.apply_info.status)))])],1),t._v(" "),a("el-row",[a("el-col",{attrs:{span:24}},[t._v("审核意见："+t._s(t.item.apply_info.opinion))])],1),t._v(" "),a("div",{staticClass:"detail-title"},[t._v("车辆信息")]),t._v(" "),a("el-row",[a("el-col",{attrs:{span:12}},[t._v("车牌号码："+t._s(t.item.car.car_license))]),t._v(" "),a("el-col",{attrs:{span:12}},[t._v("车辆品牌："+t._s(t.item.car.brand))])],1),t._v(" "),a("el-row",[a("el-col",{attrs:{span:12}},[t._v("型号："+t._s(t.item.car.model))]),t._v(" "),a("el-col",{attrs:{span:12}},[t._v("颜色："+t._s(t.item.car.color))])],1),t._v(" "),a("el-row",[a("el-col",{attrs:{span:12}},[t._v("车架号："+t._s(t.item.car.frame_number))]),t._v(" "),a("el-col",{attrs:{span:12}},[t._v("发动机号："+t._s(t.item.car.engine_number))])],1),t._v(" "),a("el-row",[a("el-col",{attrs:{span:12}},[t._v("车辆状态："+t._s(t.item.car.car_status))]),t._v(" "),a("el-col",{attrs:{span:12}},[t._v("借用情况："+t._s(t.item.car.borrow_status))])],1),t._v(" "),a("div",{staticClass:"detail-title"},[t._v("申请人信息")]),t._v(" "),a("el-row",[a("el-col",{attrs:{span:12}},[t._v("名字："+t._s(t.item.car.username))])],1),t._v(" "),a("el-row",[a("el-col",{attrs:{span:12}},[t._v("所属公司："+t._s(t.item.user_info.company))]),t._v(" "),a("el-col",{attrs:{span:12}},[t._v("所属分组："+t._s(t.item.user_info.group))])],1)],1)],1)},i=[],l={render:o,staticRenderFns:i},c=l,p=a("VU/8"),u=s,d=p(r,c,!1,u,null,null);e.default=d.exports}});
//# sourceMappingURL=12.e9ce02393b9e4171728a.js.map